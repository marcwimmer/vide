FROM ubuntu:17.04
RUN apt-get update
RUN apt-get install -y htop build-essential rsync git python cmake
RUN ls -lha /opt
RUN mkdir /root/.ssh
RUN echo "StrictHostKeyChecking no" >> /root/.ssh/config


# build vim
RUN apt-get install -y libncurses5-dev python-dev ruby-dev nodejs npm libpython-dev build-essential cmake ctags apt libtool libtool-bin autoconf automake cmake g++ pkg-config unzip wget


WORKDIR /tmp
RUN git clone https://github.com/neovim/neovim vim && \
cd /tmp/vim && git checkout __NEOVIMREVISION__
WORKDIR /tmp/vim
RUN make CMAKE_BUILD_TYPE=RelWithDebInfo && \
make install && \
nvim --version && \
cp /usr/local/bin/nvim /usr/bin/vim

RUN update-alternatives --install /usr/bin/node node /usr/bin/nodejs 10 && \
apt-get install -y automake pkg-config liblzma-dev libpcre3-dev
ADD build-silver-surfer.sh build-silver-surfer.sh
RUN rm -Rf /opt/clone_ag/ || true && \
chmod a+x ./build-silver-surfer.sh
RUN ./build-silver-surfer.sh

ADD download download
RUN chmod a+x download
RUN \
./download && \
ls -lha /opt

ADD decompression_script /opt/decompression_script
ADD compile /compile
ADD package package
RUN chmod a+x /compile package
CMD echo 'use build.sh'
